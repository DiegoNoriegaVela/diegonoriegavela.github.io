/**
 * Formatea reporte T150 (Excepciones)
 * Regla: Cada línea tiene exactamente 133 caracteres
 */
private static void formatT150Report(String transmissionId, File inputFile, 
        String outputFile, boolean debugMode) throws Exception {
    
    if (DEBUG || debugMode) {
        System.out.println("DEBUG: Aplicando formato T150 (133 caracteres por línea)");
    }

    try (BufferedReader reader = new BufferedReader(new FileReader(inputFile));
         PrintWriter writer = new PrintWriter(new FileWriter(outputFile))) {

        // Escribir header
        writer.println("[" + transmissionId + "]");

        // Leer todo el contenido
        StringBuilder content = new StringBuilder();
        String line;
        while ((line = reader.readLine()) != null) {
            content.append(line);
        }

        String fullText = content.toString();
        
        if (DEBUG || debugMode) {
            System.out.println("DEBUG: Longitud total del texto: " + fullText.length());
        }

        // Cortar en bloques de 133 caracteres
        int charsPerLine = 133;
        int totalChars = fullText.length();
        int linesWritten = 0;

        for (int i = 0; i < totalChars; i += charsPerLine) {
            int end = Math.min(i + charsPerLine, totalChars);
            String chunk = fullText.substring(i, end);
            writer.println(chunk);
            linesWritten++;
            
            if (DEBUG || debugMode && linesWritten <= 5) {
                String preview = chunk.length() > 40 ? chunk.substring(0, 40) + "..." : chunk;
                System.out.println("DEBUG: Línea " + linesWritten + ": " + chunk.length() + 
                    " chars - \"" + preview + "\"");
            }
        }

        if (DEBUG || debugMode) {
            System.out.println("DEBUG: Total de líneas escritas: " + linesWritten);
        }
    }
}
